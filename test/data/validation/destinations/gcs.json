[
  {
    "config": {
      "bucketName": "event-logs",
      "prefix": "sb",
      "credentials": "{\n  \"type\": \"service_account\",\n  \"project_id\": \"zendeskapp-52b17\",\n  \"private_key_id\": \"5c06b82205fee64749cf031ec7b3ff0bafca8c12\",\n  \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC3OaB3J8FIcsT8\\nUL1e8TruKgZDNOdAbigSteA70Ptzv2N37+LtvRENpNVsEGkP2PPu53er8jlUV9PR\\nrBXpRjS06rFhld6E2wZ2Psp5XAdHTSLTpfIX6Ly4hyn5BlhTlT0ZEEjBqvi4q6TL\\nw369rVJaymzo3U+6E617Ggt2E5E0ZfjYoEXKF2FWf7G79EBen+sVu2YrEz80S/9E\\nhrsiXGbfApLcs/CkL7eEbFmfspW5niCoYKca7AhG0uHQC4yfH9w1GbZtRvsc3dij\\npwL3+iYpUMAwfQkDCbuCjFqgpSxFzlD88Px6q5J6W59y0k0gO6bkouxL6NNPoOME\\nUNGi/noPAgMBAAECggEAGof9LOk0SzsskVlYT+cAFgbpeOeFtDuJ5kpbdGiVU1Q7\\ni91QJQW+HOrT6VMnq3RKajsuhdb20eLqg093Asbi5e71YtXn7qFP5Q/APjotvEzh\\nRfgfFLLjn5gZjfuLDwYACWDlcCnDh0DPhZ6YJntyU+mWQ1KcngCwcQVl8yHv4kAX\\nmE+C8hb12IDEsX1rB09DJSt0FqMFvwJP+PGFbOSefSykbdE6bsJpKgGlHO9FDxtk\\nieZcm2ODqocvbjWko93yWZ/Ozun9zx/59d3DVBd/EEmbzFq/OV+m7ZmcXw5mOZmg\\ntYNvQhPoXHLJQ91DE58z0Hqo5HYjys40zrLnST7A3QKBgQDpDoz8ZL2o7KK9Iyl9\\npm8xXCWxflep1w6gXjksrjsIbmw2+x3mTsmVW6i++w6eea7tGcIVQvuQlCKU+FnR\\n0eHzdrhpWrkIuLegdZ46sguXEUxcU9j6heR3aKE//z/0CIHA4hyvxJtUTf0slErJ\\n09I6xOdgVkWZctnqijSV85VejQKBgQDJQzoszq6Fm/kPNNi4Z2gZlRQq+yievNQV\\nO+4hrcONoHZNyYYHGMYqmbyZu5doltgYyMdDXzMMReJPjCnOE3McA7x5PE9jLiKa\\nMp5lcfUS81RODE+me7OA6rfIUkoNMJxYhV0TSZVBXpAxDoF/r9IZ0tQbiGRXkbhr\\nGyhAYAOSCwKBgQCodcgbOIaPcF1B8gSvunptZ3onjne3YKhF61XQojAxq/+0zleS\\nfijgOV0Ej1zF2JdE83WDAOPuYeWNYOcr71YwMgSiwt01HLA+4EX7j28pR2u24TTa\\nAaZfWdYU+GA1+WAxGEA8HRVaHvV+H8LfmKlBqcrFrBarEIXMLxJLwcKakQKBgFmf\\nlkhdwVm+GyqqXdfANJsvx8tcDLqjW84Y4fIdbveifQwmsYh3f8d4roPHBaWNhq2C\\nuzlFK3ZLqHvD7tnVz2yqPUO/l5qS8NW5tM9376qAsQoQcWexrj26SBzsiA1XmEfT\\nG597JPv3ID64NvKlWOom+E1Kb2SPf5Ayh7ojB3QBAoGAF6Jbeo3X+H12EOrPzVIV\\neUcJO2yWt7XNrGoXgLd7Hb4R9BNl8AAJqaZ9fvpTXCWNNRbaR829wuLecrc+MOJF\\n6N8Cd1s+Mjih4FE8OKVbrtc0IgM+hh2ryGrvRRF9SIDLOrEDxnsqLOHDld8FEIfl\\naOoM4S4ZRMyf2VvgqH2Lnsw=\\n-----END PRIVATE KEY-----\\n\",\n  \"client_email\": \"rudderstack@zendeskapp-52b17.iam.gserviceaccount.com\",\n  \"client_id\": \"101630212963057039580\",\n  \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n  \"token_uri\": \"https://oauth2.googleapis.com/token\",\n  \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\n  \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/rudderstack%40zendeskapp-52b17.iam.gserviceaccount.com\"\n}",
      "testConnection": false
    },
    "result": true
  },
  {
    "config": {
      "bucketName": "rudderstack-test-1",
      "prefix": "rudder",
      "credentials": ""
    },
    "result": true
  },
  {
    "config": {
      "bucketName": "Active Campaign NHN",
      "prefix": "",
      "credentials": "",
      "testConnection": false,
      "testConnectionTS": 1621944688891
    },
    "result": true
  },
  {
    "config": {
      "bucketName": "fasdfsa",
      "credentials": "{\nsadfas:\"asdf\"\n}"
    },
    "result": true
  },
  {
    "config": {
      "bucketName": 4343,
      "credentials": "{\nsadfas:\"asdf\"\n}"
    },
    "result": false,
    "err": ["bucketName must be string"]
  },
  {
    "testTitle": "With valid multiple consent management providers config",
    "config": {
      "bucketName": "event-logs",
      "consentManagement": {
        "web": [
          {
            "provider": "custom",
            "consents": [
              {
                "consent": "Marketing"
              }
            ],
            "resolutionStrategy": "or"
          },
          {
            "provider": "oneTrust",
            "consents": [
              {
                "consent": "Marketing"
              }
            ]
          },
          {
            "provider": "ketch",
            "consents": []
          }
        ]
      }
    },
    "result": true
  },
  {
    "testTitle": "With consent management custom provider config and invalid resolutionStrategy value",
    "config": {
      "bucketName": "event-logs",
      "consentManagement": {
        "android": [
          {
            "provider": "custom",
            "resolutionStrategy": "nor"
          }
        ]
      }
    },
    "result": false,
    "err": [
      "consentManagement.android.0.resolutionStrategy must be equal to one of the allowed values",
      "consentManagement.android.0 must match \"then\" schema"
    ]
  },
  {
    "testTitle": "With consent management custom provider config and no resolutionStrategy value",
    "config": {
      "bucketName": "event-logs",
      "consentManagement": {
        "android": [
          {
            "provider": "custom"
          }
        ]
      }
    },
    "result": false,
    "err": [
      "consentManagement.android.0 must have required property 'resolutionStrategy'",
      "consentManagement.android.0 must match \"then\" schema"
    ]
  },
  {
    "testTitle": "With consent management OneTrust provider config and no resolutionStrategy value",
    "config": {
      "bucketName": "event-logs",
      "consentManagement": {
        "android": [
          {
            "provider": "oneTrust"
          }
        ]
      }
    },
    "result": true
  },
  {
    "testTitle": "With consent management custom provider config invalid provider value",
    "config": {
      "bucketName": "event-logs",
      "consentManagement": {
        "android": [
          {
            "provider": "dummyProvider"
          }
        ]
      }
    },
    "result": false,
    "err": ["consentManagement.android.0.provider must be equal to one of the allowed values"]
  }
]
