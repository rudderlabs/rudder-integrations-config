{
  "configSchema": {
    "$schema": "http://json-schema.org/draft-07/schema",
    "type": "object",
    "required": ["hostName", "port", "topic"],
    "properties": {
      "hostName": {
        "type": "string",
        "pattern": "^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(\\.[A-Za-z0-9-]{1,63})*(,\\s*(?!-)[A-Za-z0-9-]{1,63}(?<!-)(\\.[A-Za-z0-9-]{1,63})*)*$"
      },
      "port": {
        "type": "string",
        "pattern": "^([1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$"
      },
      "topic": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9_.\\-]{1,249}$"
      },
      "sslEnabled": {
        "type": "boolean"
      },
      "caCertificate": {
        "type": "string",
        "pattern": ".*"
      },
      "useSSH": {
        "type": "boolean"
      },
      "sshHost": {
        "type": "string",
        "pattern": "^(?!-)[a-zA-Z0-9-.]{1,253}(?<!-)(?::\\d{1,5})?$"
      },
      "sshPort": {
        "type": "string",
        "pattern": "^([1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$"
      },
      "sshUser": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9_-]{1,32}$"
      },
      "sshPublicKey": {
        "type": "string",
        "pattern": "^ssh-(rsa|ed25519|dss) [A-Za-z0-9+/]+[=]{0,3}( [^@]+@[^@]+)?$"
      },
      "useSASL": {
        "type": "boolean"
      },
      "saslType": {
        "type": "string",
        "default": "plain",
        "enum": ["plain", "sha256", "sha512"]
      },
      "username": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9_-]{0,32}$"
      },
      "password": {
        "type": "string",
        "pattern": "^(.{0,100})$"
      },
      "convertToAvro": {
        "type": "boolean"
      },
      "avroSchemas": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "schemaId": {
              "type": "string",
              "pattern": ".*"
            },
            "schema": {
              "type": "string",
              "pattern": ".*"
            }
          }
        }
      },
      "embedAvroSchemaID": {
        "type": "boolean"
      },
      "connectionMode": {
        "type": "object",
        "properties": {
          "web": {
            "type": "string",
            "enum": ["cloud"]
          },
          "android": {
            "type": "string",
            "enum": ["cloud"]
          },
          "ios": {
            "type": "string",
            "enum": ["cloud"]
          },
          "unity": {
            "type": "string",
            "enum": ["cloud"]
          },
          "amp": {
            "type": "string",
            "enum": ["cloud"]
          },
          "cloud": {
            "type": "string",
            "enum": ["cloud"]
          },
          "warehouse": {
            "type": "string",
            "enum": ["cloud"]
          },
          "reactnative": {
            "type": "string",
            "enum": ["cloud"]
          },
          "flutter": {
            "type": "string",
            "enum": ["cloud"]
          },
          "cordova": {
            "type": "string",
            "enum": ["cloud"]
          },
          "shopify": {
            "type": "string",
            "enum": ["cloud"]
          }
        }
      },
      "oneTrustCookieCategories": {
        "type": "object",
        "properties": {
          "android": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "ios": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "web": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "unity": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "amp": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "cloud": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "warehouse": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "reactnative": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "flutter": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "cordova": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "shopify": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "oneTrustCookieCategory": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          }
        },
        "additionalProperties": false
      },
      "ketchConsentPurposes": {
        "type": "object",
        "properties": {
          "android": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "ios": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "web": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "unity": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "amp": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "cloud": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "warehouse": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "reactnative": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "flutter": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "cordova": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          },
          "shopify": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "purpose": {
                  "type": "string",
                  "pattern": "(^\\{\\{.*\\|\\|(.*)\\}\\}$)|(^env[.].+)|^(.{0,100})$"
                }
              },
              "additionalProperties": false
            }
          }
        },
        "additionalProperties": false
      }
    },
    "allOf": [
      {
        "if": {
          "properties": {
            "sslEnabled": {
              "const": true
            }
          },
          "required": ["sslEnabled"]
        },
        "then": {
          "properties": {
            "caCertificate": {
              "type": "string",
              "pattern": ".*"
            }
          }
        }
      },
      {
        "if": {
          "properties": {
            "useSSH": {
              "const": true
            }
          },
          "required": ["useSSH"]
        },
        "then": {
          "properties": {
            "sshHost": {
              "type": "string",
              "pattern": "^(?!-)[a-zA-Z0-9-.]{1,253}(?<!-)(?::\\d{1,5})?$"
            },
            "sshPort": {
              "type": "string",
              "pattern": "^([1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-5]{2}[0-3][0-5]|[1-5][0-9]{0,3}[0-9]|[1-9][0-9]?[0-9]?[0-9]?[0-9]?)$"
            },
            "sshUser": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_-]{1,32}$"
            },
            "sshPublicKey": {
              "type": "string",
              "pattern": "^ssh-(rsa|ed25519|dss) [A-Za-z0-9+/]+[=]{0,3}( [^@]+@[^@]+)?$"
            }
          },
          "required": ["sshHost", "sshPort", "sshUser", "sshPublicKey"]
        }
      },
      {
        "if": {
          "properties": {
            "sslEnabled": {
              "type": "boolean",
              "const": true
            }
          },
          "required": ["sslEnabled"]
        },
        "then": {
          "if": {
            "properties": {
              "useSASL": {
                "const": true
              }
            },
            "required": ["useSASL"]
          },
          "then": {
            "properties": {
              "saslType": {
                "type": "string",
                "default": "plain",
                "pattern": "^(plain|sha256|sha512)$"
              },
              "username": {
                "type": "string",
                "pattern": "^[a-zA-Z0-9_-]{1,32}$"
              },
              "password": {
                "type": "string",
                "pattern": "^(.{0,100})$"
              }
            },
            "required": ["saslType", "username"]
          }
        }
      },
      {
        "if": {
          "properties": {
            "convertToAvro": {
              "const": true
            }
          },
          "required": ["convertToAvro"]
        },
        "then": {
          "properties": {
            "avroSchemas": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "schemaId": {
                    "type": "string",
                    "pattern": ".*"
                  },
                  "schema": {
                    "type": "string",
                    "pattern": ".*"
                  }
                },
                "required": ["schemaId", "schema"]
              }
            }
          },
          "required": ["avroSchemas"]
        }
      }
    ],
    "additionalProperties": true
  }
}
